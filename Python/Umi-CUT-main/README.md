# Umi-CUT 批量图片去黑边/裁剪/压缩软件

批量处理图片文件，具有范围裁剪、自动去除黑/白边、调整大小、压缩体积等功能。

![](https://tupian.li/images/2022/04/15/image.png)
![](https://tupian.li/images/2022/04/15/image5f088a54bf9e3163.png)

## 下载

[Umi-CUT 批量图片转文字 v1.0.2](https://github.com/hiroi-sora/Umi-CUT/releases/tag/v1.0.2)

## 系统支持

- 源码可在绝大多数支持Python 3.x和Opencv的平台上跑起来。
- 发行版exe程序：
  - 支持 win10、win11。
  - 支持 win7 x64 sp1 及以上版本。若您无法打开本软件，请检查是否已打系统补丁 KB2533623 、KB2999226 。

## Umi-系列图片处理软件

[Umi-OCR 批量图片转文字软件](https://github.com/hiroi-sora/Umi-OCR)

**Umi-CUT 批量图片去黑边/裁剪/压缩软件 ◁**

## 简介

本软件能批量处理本地图片，具有范围裁剪、自动去除黑/白边、调整大小、压缩体积等功能。
通过范围裁剪和去黑边两种功能配合，可以绕过图片边缘的干扰色块，提取图片中部的所需内容。

> 比如下图这张Ipad截图，底部带有小白条，普通去黑边工具无法很好的去除底部黑边。
> ![](https://s1.ax1x.com/2022/04/15/L8GDRP.png)
> 
> 而 Umi-CUT 可以先设置手动范围，绕过小白条，再自动去除剩下的纯黑边框。只需设定一次，便可批量处理所有同类图片。这是开发本软件的初衷。


## 使用说明

### 准备

发行包用户：下载压缩包并解压。

Python用户：下载源码，安装好Opencv等所需模块。

### 一键去除黑边

1. 打开主程序，将任意 **图片/文件夹** 拖入窗口中的白色背景表格区域，或点击左上方的 **浏览** 选择图片。
2. 点击右上方 **开始任务** ，等待进度条走完。
   - 任务进行中，可随时点击 **终止任务**（原开始任务按钮）来停止，但下次开始时依然会从头开始。
3. 在 **第一张图片的目录** 下的 `# 裁剪` 文件夹查看输出图片。

![](https://s1.ax1x.com/2022/04/15/L8YDu8.png)

### 其他参数设置

点击 **设置** 选项卡，点击 **参数设置** 打开配置窗口。根据提示调整参数即可。
- 红色框为手动裁剪的范围。虚线框是在手动裁剪基础上，自动去除剩下黑边的范围。
- 可切换自动裁切边缘的颜色为黑色/白色。
- 若待处理图片的黑边中含有少量杂色、噪点，调高`中值滤波`参数。（但滤波值太高可能导致留下很窄的黑边）
- 若待处理图片的黑边不是纯“黑”，调高`阈值`参数。（但阈值太高可能导致需要保留的部分也被裁剪）

![](https://tupian.li/images/2022/04/15/imagef816383a8800731b.png)

## 测试

输入100张2k分辨率图片。

输出为png图片时，平均每张0.5s。

输出为jpg图片时，平均每张0.2s。

## 开发说明

- 在**参数配置窗口**加载预览图片时，若采用“拖入”的方法，对于D3色域的图片可能导致程序崩溃：
    ```
    Fatal Python error: 
    PyEval_RestoreThread: NULL tstate       
    Python runtime state: initialized
    ```
  这个崩溃貌似由opencv引起，但触发在tkinter的事件循环中(执行完业务函数以后)，所以没有办法捕捉到。采用点击左上角按钮加载预览图片则没有这个问题。对于普通sRGB图片，貌似两种方法加载预览都不会有事。保险起见，不建议使用拖入的方式加载预览。
  - 注，以上“拖入”指在参数配置的辅窗口。在批量处理的主界面直接拖入文件是没有半点问题的。
- 使用`pyinstaller`打包，可使用 `to_exe.py` 一键打包。

## 更新日志

##### v1.0.2 `2022.10.17`

- 新功能：自动裁切边缘颜色可切换黑边/白边。
- 修复了漏洞：手动裁剪数值不合法时的异常。

##### v1.0.1 `2022.4.19`

- 修复了漏洞：手动裁剪与去黑边同时进行时可能发生错位偏移。

##### v1.0.0 `2022.4.15`
